# Image System
FROM alpine

# Build Argument
ARG USER_NAME=marc
ARG USER_ID=1000
ARG GROUP_ID=1000

# Mise a jour
RUN apk --no-cache upgrade

# Installation du serveur Web
RUN apk add --no-cache apache2

# Installation de PHP
RUN apk add --no-cache php

# Creation du group et utilisateur
RUN addgroup -g $GROUP_ID $USER_NAME
RUN adduser -h /home/$USER_NAME -s /bin/ash -G $USER_NAME -D -u $USER_ID $USER_NAME
RUN addgroup marc apache

# Permission
RUN mkdir -p /var/run/apache2 /var/lock/apache2 /var/log/apache2
RUN chown -R apache:apache /var/run/apache2 /var/lock/apache2 /var/log/apache2 /var/www/html

# Utilisateur du conteneur
USER marc

# Port applicatif
EXPOSE 80

# Volume
VOLUME /var/www/html

# WorkDir
WORKDIR /var/www/html

# Commande
ENTRYPOINT ["/usr/sbin/httpd"]

# Argument
CMD ["-D","FOREGROUND"]
