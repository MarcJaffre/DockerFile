# Use Debian as the base image
FROM debian:latest

# Set the environment variable
ENV container=docker

# Update the package list
RUN apt update

# Install systemd and dumb-init
RUN apt install -y systemd dumb-init runit

# Cr√©ez l'utilisateur et le groupe docker
RUN groupadd -r docker && useradd -r -g docker docker

# Configure systemd pour utiliser l'utilisateur et le groupe docker
RUN sed -i 's/^User=.*/User=docker/' /etc/systemd/system.conf
RUN sed -i 's/^Group=.*/Group=docker/' /etc/systemd/system.conf

# Expose the command to run systemd with dumb-init and --user option
CMD ["dumb-init", "--", "/usr/sbin/runit"]
