# Use an official Debian image as the base
FROM debian:latest

# Set the working directory to /app
WORKDIR /app

# Install systemd and other dependencies
RUN apt-get update && apt-get install -y systemd systemd-sysv

# Create a new user with privileged access
RUN useradd -m -s /bin/bash myuser
USER myuser

# Create a service file for systemd
RUN echo "[Unit]
Description=My Service
After=network.target

[Service]
User=myuser
ExecStart=/usr/bin/mycommand
Restart=always

[Install]
WantedBy=multi-user.target" > /etc/systemd/system/my.service

# Reload systemd daemon and enable the service
RUN systemctl daemon-reload
RUN systemctl enable my.service

# Start the service when the container starts
CMD ["systemctl", "start", "my.service"]
